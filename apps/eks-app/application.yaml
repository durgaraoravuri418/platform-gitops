apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: my-app
  namespace: argocd
spec:
  project: default

  sources:

  # ðŸ”¹ Source-1 â†’ Helm chart (templates)
  - repoURL: https://github.com/durgaraoravuri418/eks-app
    targetRevision: master
    path: .
    helm:
      valueFiles:
        - $values/apps/eks-app/values.yaml   # <-- reference values from 2nd source

  # ðŸ”¹ Source-2 â†’ GitOps repo (values only)
  - repoURL: https://github.com/durgaraoravuri418/platform-gitops
    targetRevision: master
    ref: values   # <-- mark as values source (NO Chart.yaml expected)

  destination:
    server: https://kubernetes.default.svc
    namespace: my-app-dev

  syncPolicy:
    automated:
      prune: true
      selfHeal: true
